{"name":"COS_CHURN_to_TEST_flow","description":"","pipeline":{"version":"1.0","doc_type":"pipeline","app_data":{"shaperCreated":true,"replace_space_by_dot":true},"primary_pipeline":"pipeline1","pipelines":[{"id":"pipeline1","nodes":[{"id":"source1","app_data":{"sampling":{"type":"topRows","size":10000}},"data_asset":{"properties":{"row_start":"0","first_line_header":"true","quote_character":"double_quote","encoding":"UTF-8","escape_character":"double_quote","invalid_data_handling":"fail","file_format":"csv"},"ref":"data_asset.COSCHURNcsv","app_data":{"dataset_name":"COS_CHURN.csv"}},"type":"binding","output":{"id":"source1output"}},{"id":"571c6250-4a09-443f-9e72-93abd31003bc","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"mutate","code":"mutate(`POLICYHOLDER_ID` = as.integer(`POLICYHOLDER_ID`),`CHURN` = as.double(`CHURN`),`CHURN_DATE` = as.Date(lubridate::parse_date_time(`CHURN_DATE`, \"ymd\", quiet=TRUE)),`HOUSEHOLD_ID` = as.integer(`HOUSEHOLD_ID`),`AGE` = as.integer(`AGE`),`CONTACT` = as.integer(`CONTACT`),`INCOME` = as.double(`INCOME`),`INSURANCE_SCORE` = as.double(`INSURANCE_SCORE`),`NUMBER_OF_MEMBERS` = as.integer(`NUMBER_OF_MEMBERS`),`HOUSEHOLD_NUMBER_OF_CHILDREN` = as.integer(`HOUSEHOLD_NUMBER_OF_CHILDREN`),`HOUSEHOLD_NUMBER_OF_INSURED_CARS` = as.integer(`HOUSEHOLD_NUMBER_OF_INSURED_CARS`),`NUMBER_OF_POLICIES_IN_HOUSEHOLD` = as.integer(`NUMBER_OF_POLICIES_IN_HOUSEHOLD`),`HOUSEHOLD_TENURE` = as.double(`HOUSEHOLD_TENURE`),`HOUSEHOLD_PREMIUM` = as.double(`HOUSEHOLD_PREMIUM`),`PROPERTY_MARKET_VALUE` = as.double(`PROPERTY_MARKET_VALUE`),`HOUSEHOLD_DISPOSABLE_INCOME` = as.double(`HOUSEHOLD_DISPOSABLE_INCOME`),`GROSS_INCOME_MONTHLY` = as.double(`GROSS_INCOME_MONTHLY`),`FIRST_HEAD_SMOKER` = as.double(`FIRST_HEAD_SMOKER`),`RESIDENCY_LENGTH` = as.double(`RESIDENCY_LENGTH`),`SECOND_HEAD_SMOKER` = as.double(`SECOND_HEAD_SMOKER`),`POLICYHOLDER_SATISFACTION_DURATION` = as.double(`POLICYHOLDER_SATISFACTION_DURATION`),`AVERAGE_CLAIM_AMOUNT` = as.double(`AVERAGE_CLAIM_AMOUNT`),`INSURANCE_LINES` = as.integer(`INSURANCE_LINES`),`NUMBER_OF_POLICIES` = as.integer(`NUMBER_OF_POLICIES`),`NUMBER_OF_POLICIES_SURRENDERED` = as.integer(`NUMBER_OF_POLICIES_SURRENDERED`),`TOTAL_PREMIUM` = as.double(`TOTAL_PREMIUM`),`CLAIM_SETTLEMENT_DURATION` = as.double(`CLAIM_SETTLEMENT_DURATION`),`LATEST_NOTE_ATTITUDE` = as.double(`LATEST_NOTE_ATTITUDE`),`AVERAGE_NOTE_ATTITUDE` = as.double(`AVERAGE_NOTE_ATTITUDE`),`CLTV_VALUE` = as.double(`CLTV_VALUE`),`CHURN_SCORE` = as.double(`CHURN_SCORE`),`CHANNEL_PROPENSITY_SCORE` = as.double(`CHANNEL_PROPENSITY_SCORE`),`POLICYHOLDER_TENURE` = as.double(`POLICYHOLDER_TENURE`),`NUMBER_OF_COMPLAINTS` = as.double(`NUMBER_OF_COMPLAINTS`),`NUMBER_OF_OPEN_COMPLAINTS` = as.double(`NUMBER_OF_OPEN_COMPLAINTS`),`NO_OF_CLOSED_COMPLAINTS` = as.double(`NO_OF_CLOSED_COMPLAINTS`),`NUMBER_OF_CLAIMS_FILED` = as.double(`NUMBER_OF_CLAIMS_FILED`),`NUMBER_OF_CLAIMS_DENIED` = as.double(`NUMBER_OF_CLAIMS_DENIED`),`MAINTENANCE_COST` = as.double(`MAINTENANCE_COST`))","args":{"type":"mutate","conditions":[],"auto":true,"autoConditions":[{"column":"POLICYHOLDER_ID","type":"as.integer","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"CHURN","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"CHURN_DATE","type":"lubridate::mdy","newColumnName":"","format":"ymd","actualType":"character","removeColumn":false},{"column":"HOUSEHOLD_ID","type":"as.integer","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"AGE","type":"as.integer","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"CONTACT","type":"as.integer","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"INCOME","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"INSURANCE_SCORE","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"NUMBER_OF_MEMBERS","type":"as.integer","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"HOUSEHOLD_NUMBER_OF_CHILDREN","type":"as.integer","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"HOUSEHOLD_NUMBER_OF_INSURED_CARS","type":"as.integer","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"NUMBER_OF_POLICIES_IN_HOUSEHOLD","type":"as.integer","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"HOUSEHOLD_TENURE","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"HOUSEHOLD_PREMIUM","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"PROPERTY_MARKET_VALUE","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"HOUSEHOLD_DISPOSABLE_INCOME","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"GROSS_INCOME_MONTHLY","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"FIRST_HEAD_SMOKER","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"RESIDENCY_LENGTH","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"SECOND_HEAD_SMOKER","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"POLICYHOLDER_SATISFACTION_DURATION","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"AVERAGE_CLAIM_AMOUNT","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"INSURANCE_LINES","type":"as.integer","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"NUMBER_OF_POLICIES","type":"as.integer","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"NUMBER_OF_POLICIES_SURRENDERED","type":"as.integer","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"TOTAL_PREMIUM","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"CLAIM_SETTLEMENT_DURATION","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"LATEST_NOTE_ATTITUDE","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"AVERAGE_NOTE_ATTITUDE","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"CLTV_VALUE","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"CHURN_SCORE","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"CHANNEL_PROPENSITY_SCORE","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"POLICYHOLDER_TENURE","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"NUMBER_OF_COMPLAINTS","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"NUMBER_OF_OPEN_COMPLAINTS","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"NO_OF_CLOSED_COMPLAINTS","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"NUMBER_OF_CLAIMS_FILED","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"NUMBER_OF_CLAIMS_DENIED","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"MAINTENANCE_COST","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false}],"version":10}}},"parameters":{"FREEFORM_CODE":"mutate(`POLICYHOLDER_ID` = as.integer(`POLICYHOLDER_ID`),`CHURN` = as.double(`CHURN`),`CHURN_DATE` = stringToDateYMD(`CHURN_DATE`),`HOUSEHOLD_ID` = as.integer(`HOUSEHOLD_ID`),`AGE` = as.integer(`AGE`),`CONTACT` = as.integer(`CONTACT`),`INCOME` = as.double(`INCOME`),`INSURANCE_SCORE` = as.double(`INSURANCE_SCORE`),`NUMBER_OF_MEMBERS` = as.integer(`NUMBER_OF_MEMBERS`),`HOUSEHOLD_NUMBER_OF_CHILDREN` = as.integer(`HOUSEHOLD_NUMBER_OF_CHILDREN`),`HOUSEHOLD_NUMBER_OF_INSURED_CARS` = as.integer(`HOUSEHOLD_NUMBER_OF_INSURED_CARS`),`NUMBER_OF_POLICIES_IN_HOUSEHOLD` = as.integer(`NUMBER_OF_POLICIES_IN_HOUSEHOLD`),`HOUSEHOLD_TENURE` = as.double(`HOUSEHOLD_TENURE`),`HOUSEHOLD_PREMIUM` = as.double(`HOUSEHOLD_PREMIUM`),`PROPERTY_MARKET_VALUE` = as.double(`PROPERTY_MARKET_VALUE`),`HOUSEHOLD_DISPOSABLE_INCOME` = as.double(`HOUSEHOLD_DISPOSABLE_INCOME`),`GROSS_INCOME_MONTHLY` = as.double(`GROSS_INCOME_MONTHLY`),`FIRST_HEAD_SMOKER` = as.double(`FIRST_HEAD_SMOKER`),`RESIDENCY_LENGTH` = as.double(`RESIDENCY_LENGTH`),`SECOND_HEAD_SMOKER` = as.double(`SECOND_HEAD_SMOKER`),`POLICYHOLDER_SATISFACTION_DURATION` = as.double(`POLICYHOLDER_SATISFACTION_DURATION`),`AVERAGE_CLAIM_AMOUNT` = as.double(`AVERAGE_CLAIM_AMOUNT`),`INSURANCE_LINES` = as.integer(`INSURANCE_LINES`),`NUMBER_OF_POLICIES` = as.integer(`NUMBER_OF_POLICIES`),`NUMBER_OF_POLICIES_SURRENDERED` = as.integer(`NUMBER_OF_POLICIES_SURRENDERED`),`TOTAL_PREMIUM` = as.double(`TOTAL_PREMIUM`),`CLAIM_SETTLEMENT_DURATION` = as.double(`CLAIM_SETTLEMENT_DURATION`),`LATEST_NOTE_ATTITUDE` = as.double(`LATEST_NOTE_ATTITUDE`),`AVERAGE_NOTE_ATTITUDE` = as.double(`AVERAGE_NOTE_ATTITUDE`),`CLTV_VALUE` = as.double(`CLTV_VALUE`),`CHURN_SCORE` = as.double(`CHURN_SCORE`),`CHANNEL_PROPENSITY_SCORE` = as.double(`CHANNEL_PROPENSITY_SCORE`),`POLICYHOLDER_TENURE` = as.double(`POLICYHOLDER_TENURE`),`NUMBER_OF_COMPLAINTS` = as.double(`NUMBER_OF_COMPLAINTS`),`NUMBER_OF_OPEN_COMPLAINTS` = as.double(`NUMBER_OF_OPEN_COMPLAINTS`),`NO_OF_CLOSED_COMPLAINTS` = as.double(`NO_OF_CLOSED_COMPLAINTS`),`NUMBER_OF_CLAIMS_FILED` = as.double(`NUMBER_OF_CLAIMS_FILED`),`NUMBER_OF_CLAIMS_DENIED` = as.double(`NUMBER_OF_CLAIMS_DENIED`),`MAINTENANCE_COST` = as.double(`MAINTENANCE_COST`))"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"source1","port_id_ref":"source1output"}]}],"outputs":[{"id":"outputPort1"}]},{"id":"d12b1a03-d421-4c3e-9ba9-d11a6bde910d","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"drop","code":"select(-`CHURN`)","args":{"column":"CHURN"}}},"parameters":{"FREEFORM_CODE":"select(-`CHURN`)"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"571c6250-4a09-443f-9e72-93abd31003bc","port_id_ref":"outputPort1"}]}],"outputs":[{"id":"outputPort2"}]},{"id":"674260be-65e4-4ef7-83e2-04635189b1d6","type":"execution_node","op":"com.ibm.wdp.transformer.RandomSample","app_data":{"uiParams":{"key":"sampling","code":"","args":{"type":"random","sampletype":"MAX_ROWS","samplevalue":"100","replacementflag":false,"stratificationMethod":"auto","stratifiedSortOption":false,"allStrataSortColumn":"","allStrataSortOrder":"","stratas":[],"version":1}}},"parameters":{"MAX_ROWS":100,"WITH_REPLACEMENT":false},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"d12b1a03-d421-4c3e-9ba9-d11a6bde910d","port_id_ref":"outputPort2"}]}],"outputs":[{"id":"outputPort3"}]},{"id":"target1","data_asset":{"properties":{"file_format":"csv","mode":"overwrite","first_line_header":false,"name":"COS_CHURN_TEST.csv","write_mode":"write","partitioned":false,"partition_name_prefix":"part","quote_numerics":true,"encoding":"utf-8"},"app_data":{}},"type":"binding","input":{"id":"targetInput1","link":{"node_id_ref":"674260be-65e4-4ef7-83e2-04635189b1d6","port_id_ref":"outputPort3"}}}],"runtime":"Spark"}]}}